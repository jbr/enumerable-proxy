See http://www.jacobrothstein.com/entries/enumerable-proxy

and

http://www.jacobrothstein.com/entries/further-enumerable-proxy